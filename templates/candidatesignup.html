<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Candidate Portal - AuthentiHire</title>
     <link rel="stylesheet" href="{{ url_for('static', filename='css files/style1.css')}}">
    <link rel="stylesheet" href="{{ url_for('static', filename='css files/style2.css')}}">
   
<script src="{{ url_for('static', filename='js files/javascript.js') }}"></script>
</head>
<body>
  <header class="navbar">
    <div class="logo">AuthentiHire</div>
    <ul class="nav-links">
      <li><a href="/">Home</a></li>
      <li><a href="/about">About</a></li>
      <li><a href="/contact">Contact</a></li>
    </ul>
    <!-- Dark Mode Toggle -->
    <button class="toggle-btn" onclick="toggleMode()" aria-label="Toggle Dark Mode">ðŸŒ™ Dark Mode</button>
  </header>

  <section class="auth-section">
    <h2>Candidate Portal</h2>

    <!-- Toggle between Login / SignUp -->
    <div class="tabs">
      <div class="tab-item">
        <p>Already have an account?</p>
        <button onclick="showForm('login')">Login</button>
      </div>
      <div class="tab-item">
        <p>Donâ€™t have an account?</p>
        <button onclick="showForm('signup')">Sign Up</button>
      </div>
    </div>

    <!-- Candidate Login Form -->
    <form id="loginForm" class="auth-form">
      <h3>Login as Candidate</h3>
      <input type="email" placeholder="Email" required>
      <input type="password" placeholder="Password" required>
      <button type="submit">Login</button>
    </form>

    <!-- Candidate Signup Form -->
    <form id="signupForm" class="auth-form hidden" enctype="multipart/form-data">
      <h3>Create Candidate Account</h3>

      <!-- Step 1: Basic Info -->
      <div class="signup-box" style="background: rgba(0, 123, 255, 0.2); padding: 20px; border-radius: 15px; margin-bottom: 15px;">
        <input type="text" placeholder="Full Name" required style="margin-bottom: 10px;">
        <input type="text" placeholder="Username" required style="margin-bottom: 10px;">
        <input type="email" placeholder="Email" required style="margin-bottom: 10px;">
        <button type="button" id="sendOtpBtn" style="background: #007bff; color: white; border: none; padding: 10px; border-radius: 10px; cursor: pointer;">Send OTP</button>
      </div>

      <!-- Step 2: OTP + Password + Resume Upload -->
      <div class="signup-box" style="background: rgba(255, 255, 255, 0.05); padding: 20px; border-radius: 15px;">
        <input type="text" placeholder="Enter OTP" required style="margin-bottom: 10px;">
        <input type="password" placeholder="Create Password" required>
        <input type="password" placeholder="Confirm Password" required style="margin-top: 10px; margin-bottom: 10px;">

        
      </div>

      <button type="submit" style="margin-top: 15px;">Sign Up</button>
    </form>
  </section>

  <script>
    // Toggle between login and signup
    function showForm(type) {
      document.getElementById("loginForm").classList.add("hidden");
      document.getElementById("signupForm").classList.add("hidden");
      if (type === "login") {
        document.getElementById("loginForm").classList.remove("hidden");
      } else {
        document.getElementById("signupForm").classList.remove("hidden");
      }
    }

    // OTP + Password confirmation logic
    const signupForm = document.getElementById("signupForm");
    const sendOtpBtn = document.getElementById("sendOtpBtn");

    sendOtpBtn.addEventListener("click", async () => {
      const email = signupForm.querySelector('input[placeholder="Email"]').value;

      if (!email) {
        alert("Please enter your email to send OTP");
        return;
      }

      try {
        const response = await fetch("/send-otp", {
          method: "POST",
          headers: { "Content-Type": "application/json" },
          body: JSON.stringify({ email })
        });
        const data = await response.json();

        if (data.success) {
          alert("OTP sent to your email!");
        } else {
          alert("Error sending OTP: " + data.message);
        }
      } catch (err) {
        console.error(err);
        alert("Server error. Check your backend.");
      }
    });

    signupForm.addEventListener("submit", async function(e) {
  e.preventDefault();

  const name = signupForm.querySelector('input[placeholder="Full Name"]').value;
  const username = signupForm.querySelector('input[placeholder="Username"]').value;
  const email = signupForm.querySelector('input[placeholder="Email"]').value;
  const otp = signupForm.querySelector('input[placeholder="Enter OTP"]').value;
  const password = signupForm.querySelector('input[placeholder="Create Password"]').value;
  const confirmPassword = signupForm.querySelector('input[placeholder="Confirm Password"]').value;

  if (password !== confirmPassword) {
    alert("Passwords do not match!");
    return;
  }

  try {
    const res = await fetch("/candidate-signup", {
      method: "POST",
      headers: { "Content-Type": "application/json" },
      body: JSON.stringify({ name, username, email, otp, password })
    });
    const data = await res.json();
if (data.success) {
  alert("Signup successful!");
  window.location.href = "/candidateportal";  // redirect after signup
}

    else {
      alert("Signup failed: " + data.message);
    }
  } catch (err) {
    console.error("Signup Error:", err);
    alert("Server error during signup.");
  }
});
const loginForm = document.getElementById("loginForm");

loginForm.addEventListener("submit", async function(e) {
  e.preventDefault();

  const email = loginForm.querySelector('input[placeholder="Email"]').value;
  const password = loginForm.querySelector('input[placeholder="Password"]').value;

  try {
    const res = await fetch("/candidate-login", {
      method: "POST",
      headers: { "Content-Type": "application/json" },
      body: JSON.stringify({ email, password })
    });
    const data = await res.json();

    if (data.success) {
  alert("Login successful!");
  window.location.href = "/candidateportal";  // redirect to host meeting page
}
else {
      alert("Login failed: " + data.message);
    }
  } catch (err) {
    console.error("Login Error:", err);
    alert("Server error during login.");
  }
});


    // Dark/Light mode toggle
    function toggleMode() {
      document.body.classList.toggle("dark-mode");
      const btn = document.querySelector(".toggle-btn");

      if (document.body.classList.contains("dark-mode")) {
        btn.textContent = "â˜€ Light Mode";
        localStorage.setItem("theme", "dark");
      } else {
        btn.textContent = "ðŸŒ™ Dark Mode";
        localStorage.setItem("theme", "light");
      }
    }

    // Preserve mode
    window.onload = () => {
      if (localStorage.getItem("theme") === "dark") {
        document.body.classList.add("dark-mode");
        document.querySelector(".toggle-btn").textContent = "â˜€ Light Mode";
      }
    };

    // Tab animation
    window.addEventListener("DOMContentLoaded", () => {
      const tabItems = document.querySelectorAll('.tab-item');
      tabItems.forEach((item, idx) => {
        setTimeout(() => item.classList.add('show'), idx * 200);
      });
    });

    // Scroll animation
    const observer = new IntersectionObserver((entries) => {
      entries.forEach(entry => {
        if (entry.isIntersecting) {
          entry.target.classList.add('show');
        }
      });
    }, { threshold: 0.2 });

    document.querySelectorAll('.auth-section, .tabs button, .auth-form input, .auth-form button')
      .forEach(el => observer.observe(el));

    const elements = document.querySelectorAll('.tabs button, .auth-form button');
    elements.forEach((el, idx) => {
      observer.observe(el);
      el.style.transitionDelay = `${idx * 0.1}s`;
    });
   
  </script>
  <script>
  window.addEventListener('scroll', () => {
    document.querySelectorAll('.reveal').forEach((el) => {
      const rect = el.getBoundingClientRect();
      if (rect.top < window.innerHeight - 100) {
        el.classList.add('active');
      }
    });
  });
</script>

</body>
</html>