<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>AI Verification Results</title>
<style>
    body { font-family: Arial, sans-serif; margin: 20px; background: #f4f4f4; }
    table { border-collapse: collapse; width: 100%; background: #fff; }
    th, td { border: 1px solid #ccc; padding: 10px; text-align: left; }
    th { background-color: #007bff; color: white; }
    tr:nth-child(even) { background-color: #f2f2f2; }
    #finalResults { padding: 15px; background: #1f2833; color: #fff; border-radius: 10px; margin-bottom: 20px; }
</style>
</head>
<body>
<h1>AI Verification Results</h1>

<div id="finalResults">
    <h3>AI Analysis Results</h3>
    {% for feature, status in results.items() %}
        <p><b>{{ feature }}:</b> {{ status }}</p>
    {% endfor %}
</div>


<table>
    <tr>
        <th>ID</th>
        <th>User ID</th>
        <th>Feature</th>
        <th>Status</th>
        <th>Timestamp</th>
    </tr>
    {% for row in results_table %}
    <tr>
        <td>{{ row[0] }}</td>
        <td>{{ row[1] }}</td>
        <td>{{ row[2] }}</td>
        <td>{{ row[3] }}</td>
        <td>{{ row[4] }}</td>
    </tr>
    {% endfor %}
</table>


<script src="https://cdn.socket.io/4.7.2/socket.io.min.js"></script>
<script>
const socket = io();

// Listen for live AI updates
socket.on('ai_status_update', function(data) {
    const finalResultsDiv = document.getElementById('finalResults');

    // Update summary
    let p = document.getElementById(`result-${data.feature}`);
    if (!p) {
        p = document.createElement('p');
        p.id = `result-${data.feature}`;
        finalResultsDiv.appendChild(p);
    }
    p.innerHTML = `<b>${data.feature.replace(/_/g,' ')}:</b> ${data.status}`;

    // Update table
    const table = document.querySelector('table');
    const row = document.createElement('tr');
    const timestamp = new Date().toISOString().slice(0,19).replace('T',' ');
    row.innerHTML = `
        <td>--</td>
        <td>${data.source}</td>
        <td>${data.feature.replace(/_/g,' ')}</td>
        <td>${data.status}</td>
        <td>${timestamp}</td>
    `;
    table.appendChild(row);
});
</script>

</body>
</html>